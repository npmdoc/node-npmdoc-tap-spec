<div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a

        href="https://github.com/scottcorgan/tap-spec#readme"

    >tap-spec (v4.1.1)</a>
</h1>
<h4>Formatted TAP output like Mocha's spec reporter</h4>
<div class="apidocSectionDiv"><a
    href="#apidoc.tableOfContents"
    id="apidoc.tableOfContents"
><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.tap-spec">module tap-spec</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.tap-spec.tap-spec">
            function <span class="apidocSignatureSpan"></span>tap-spec
            <span class="apidocSignatureSpan">(spec)</span>
            </a>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.tap-spec" id="apidoc.module.tap-spec">module tap-spec</a></h1>


    <h2>
        <a href="#apidoc.element.tap-spec.tap-spec" id="apidoc.element.tap-spec.tap-spec">
        function <span class="apidocSignatureSpan"></span>tap-spec
        <span class="apidocSignatureSpan">(spec)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">tap-spec = function (spec) {

  spec = spec || {};

  var OUTPUT_PADDING = spec.padding || &#x27;  &#x27;;

  var output = through();
  var parser = tapOut();
  var stream = duplexer(parser, output);
  var startTime = new Date().getTime();

  output.push(&#x27;\n&#x27;);

  parser.on(&#x27;test&#x27;, function (test) {

    output.push(&#x27;\n&#x27; + pad(format.underline(test.name)) + &#x27;\n\n&#x27;);
  });

  // Passing assertions
  parser.on(&#x27;pass&#x27;, function (assertion) {

    var glyph = format.green(symbols.tick);
    var name = format.dim(assertion.name);

    output.push(pad(&#x27;  &#x27; + glyph + &#x27; &#x27; + name + &#x27;\n&#x27;));
  });

  // Failing assertions
  parser.on(&#x27;fail&#x27;, function (assertion) {

    var glyph = symbols.cross;
    var title =  glyph + &#x27; &#x27; + assertion.name;
    var raw = format.cyan(prettifyRawError(assertion.error.raw));
    var divider = _.fill(
      new Array((title).length + 1),
      &#x27;-&#x27;
    ).join(&#x27;&#x27;);

    output.push(&#x27;\n&#x27; + pad(&#x27;  &#x27; + format.red(title) + &#x27;\n&#x27;));
    output.push(pad(&#x27;  &#x27; + format.red(divider) + &#x27;\n&#x27;));
    output.push(raw);

    stream.failed = true;
  });

  parser.on(&#x27;comment&#x27;, function (comment) {

    output.push(pad(&#x27;  &#x27; + format.yellow(comment.raw)) + &#x27;\n&#x27;);
  });

  // All done
  parser.on(&#x27;output&#x27;, function (results) {

    output.push(&#x27;\n\n&#x27;);

    // Most likely a failure upstream
    if (results.plans.length &#x3c; 1) {
      process.exit(1);
    }

    if (results.fail.length &#x3e; 0) {
      output.push(formatErrors(results));
      output.push(&#x27;\n&#x27;);
    }

    output.push(formatTotals(results));
    output.push(&#x27;\n\n\n&#x27;);

    // Exit if no tests run. This is a result of 1 of 2 things:
    //  1. No tests were written
    //  2. There was some error before the TAP got to the parser
    if (results.tests.length === 0) {
      process.exit(1);
    }
  });

  // Utils

  function prettifyRawError (rawError) {

    return rawError.split(&#x27;\n&#x27;).map(function (line) {

      return pad(line);
    }).join(&#x27;\n&#x27;) + &#x27;\n\n&#x27;;
  }

  function formatErrors (results) {

    var failCount = results.fail.length;
    var past = (failCount === 1) ? &#x27;was&#x27; : &#x27;were&#x27;;
    var plural = (failCount === 1) ? &#x27;failure&#x27; : &#x27;failures&#x27;;

    var out = &#x27;\n&#x27; + pad(format.red.bold(&#x27;Failed Tests:&#x27;) + &#x27; There &#x27; + past + &#x27; &#x27; + format.red.bold(failCount) + &#x27; &#x27; + plural + &#x27;\n&#x27;);
    out += formatFailedAssertions(results);

    return out;
  }

  function formatTotals (results) {

    if (results.tests.length === 0) {
      return pad(format.red(symbols.cross + &#x27; No tests found&#x27;));
    }

    return _.filter([
      pad(&#x27;total:     &#x27; + results.asserts.length),
      pad(format.green(&#x27;passing:   &#x27; + results.pass.length)),
      results.fail.length &#x3e; 0 ? pad(format.red(&#x27;failing:   &#x27; + results.fail.length)) : undefined,
      pad(&#x27;duration:  &#x27; + prettyMs(new Date().getTime() - startTime))
    ], _.identity).join(&#x27;\n&#x27;);
  }

  function formatFailedAssertions (results) {

    var out = &#x27;&#x27;;

    var groupedAssertions = _.groupBy(results.fail, function (assertion) {
      return assertion.test;
    });

    _.each(groupedAssertions, function (assertions, testNumber) {

      // Wrie failed assertion&#x27;s test name
      var test = _.find(results.tests, {number: parseInt(testNumber)});
      out += &#x27;\n&#x27; + pad(&#x27;  &#x27; + test.name + &#x27;\n\n&#x27;);

      // Write failed assertion
      _.each(assertions, function (assertion) {

        out += pad(&#x27;    &#x27; + format.red(symbols.cross) + &#x27; &#x27; + format.red(assertion.name)) + &#x27;\n&#x27;;
      });

      out += &#x27;\n&#x27;;
    });

    return out;
  }

  function pad (str) {

    return OUTPUT_PADDING + str;
  }

  return stream;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
